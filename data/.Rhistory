?gflextable()
?gflextable
??gflextable
setwd('/Users/yadonistroman/Documents/GitHub/trustus-r/data')
library(tidyverse)
library(readxl)
df <- read_excel('total.xlsx')
# добавим столбец сезон
season_v <- rep(c('зима', 'весна', 'лето', 'осень'), each=3)
season_v <- season_v[2:12]
season_v <- c(season_v, season_v[1])
season_v <- rep(season_v, 83)
df <- df %>% add_column('Сезон' = season_v, .before = 'Квартал')
df$Сезон <- factor(df$Сезон, levels = c('зима', 'весна', 'лето', 'осень'))
# 1
str(df)
mod_reg_pa <- lm(data = df, Индекс.ПА ~ `Среднемесячная з.п.` + `Число абонентов` + `Уровень безработицы` + Сезон)
summary(mod_reg_pa)
mod_reg_bp <- lm(data = df, Индекс.БП ~ `Среднемесячная з.п.` + `Число абонентов` + `Уровень безработицы` + Сезон)
summary(mod_reg_bp)
# 2
df <- df %>% mutate(`Онлайн-заявки dummy` = ifelse(`Онлайн-заявки` > `Офлайн-заявки`, 1, 0))
# 3
df_ipot <- df %>% select(Регион, `Всего ипотечных сделок`)
df_ipot$`Всего ипотечных сделок` <- gsub(' ', '', df_ipot$`Всего ипотечных сделок`)
df_ipot$`Всего ипотечных сделок` <- gsub('>', '', df_ipot$`Всего ипотечных сделок`)
ipot_list <- strsplit(df_ipot$`Всего ипотечных сделок`, '-')
ipot_v <- c()
for (i in ipot_list) {
ipot_v <- c(ipot_v, i[1])
}
df_ipot$`Всего ипотечных сделок` <- as.numeric(ipot_v)
df_ipot <- df_ipot %>% mutate(`Ипотечые сделки dummy` = ifelse(`Всего ипотечных сделок` >= 500, 1, 0))
df$`Ипотечые сделки dummy` <- df_ipot$`Ипотечые сделки dummy`
# 4
mod_lreg_online <- glm(data = df, `Онлайн-заявки dummy` ~ `Среднемесячная з.п.` +
`Число абонентов` +
`Уровень безработицы` +
Сезон,
family = 'binomial')
summary(mod_lreg_online)
exp(coef(mod_lreg_online))
# 5
mod_lreg_ipot <- glm(data = df, `Ипотечые сделки dummy` ~ `Среднемесячная з.п.` +
`Число абонентов` +
`Уровень безработицы` +
Сезон,
family = 'binomial')
summary(mod_lreg_ipot)
exp(coef(mod_lreg_ipot))
stargazer(mod_lreg_ipot)
setwd('/Users/yadonistroman/Documents/GitHub/trustus-r/data')
library(tidyverse)
library(readxl)
library(stargazer)
df <- read_excel('total.xlsx')
# добавим столбец сезон
season_v <- rep(c('зима', 'весна', 'лето', 'осень'), each=3)
season_v <- season_v[2:12]
season_v <- c(season_v, season_v[1])
season_v <- rep(season_v, 83)
df <- df %>% add_column('Сезон' = season_v, .before = 'Квартал')
df$Сезон <- factor(df$Сезон, levels = c('зима', 'весна', 'лето', 'осень'))
# 1
str(df)
mod_reg_pa <- lm(data = df, Индекс.ПА ~ `Среднемесячная з.п.` + `Число абонентов` + `Уровень безработицы` + Сезон)
summary(mod_reg_pa)
mod_reg_bp <- lm(data = df, Индекс.БП ~ `Среднемесячная з.п.` + `Число абонентов` + `Уровень безработицы` + Сезон)
summary(mod_reg_bp)
# 2
df <- df %>% mutate(`Онлайн-заявки dummy` = ifelse(`Онлайн-заявки` > `Офлайн-заявки`, 1, 0))
# 3
df_ipot <- df %>% select(Регион, `Всего ипотечных сделок`)
df_ipot$`Всего ипотечных сделок` <- gsub(' ', '', df_ipot$`Всего ипотечных сделок`)
df_ipot$`Всего ипотечных сделок` <- gsub('>', '', df_ipot$`Всего ипотечных сделок`)
ipot_list <- strsplit(df_ipot$`Всего ипотечных сделок`, '-')
ipot_v <- c()
for (i in ipot_list) {
ipot_v <- c(ipot_v, i[1])
}
df_ipot$`Всего ипотечных сделок` <- as.numeric(ipot_v)
df_ipot <- df_ipot %>% mutate(`Ипотечые сделки dummy` = ifelse(`Всего ипотечных сделок` >= 500, 1, 0))
df$`Ипотечые сделки dummy` <- df_ipot$`Ипотечые сделки dummy`
# 4
mod_lreg_online <- glm(data = df, `Онлайн-заявки dummy` ~ `Среднемесячная з.п.` +
`Число абонентов` +
`Уровень безработицы` +
Сезон,
family = 'binomial')
summary(mod_lreg_online)
exp(coef(mod_lreg_online))
# 5
mod_lreg_ipot <- glm(data = df, `Ипотечые сделки dummy` ~ `Среднемесячная з.п.` +
`Число абонентов` +
`Уровень безработицы` +
Сезон,
family = 'binomial')
summary(mod_lreg_ipot)
exp(coef(mod_lreg_ipot))
stargazer(mod_lreg_ipot)
small <- df[, c(6, 7, 8)]
cor(small)
fitted_v <- mod_lreg_online$fitted.values
print(fitted_v)
summary(fitted_v)
install.packages('pROC')
library(pROC)
library(pROC)
roc(mod_lreg_online)
roc_onlin <- roc(df$`Ипотечые сделки dummy` ~ mod_lreg_ipot$fitted.values)
roc_onlin <- roc(df$`Ипотечые сделки dummy` ~ mod_lreg_ipot$fitted.values)
roc_onlin$percent
roc_onlin
roc_onlin$auc
